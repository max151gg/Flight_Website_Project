@using SkyPath_Models.Models
@using SkyPath_Models.ViewModel
@model BrowseViewModel

@{
    var cityDict = (Dictionary<string, string>)ViewBag.CityDict;

    string NameOrUnknown(string id) =>
        (!string.IsNullOrEmpty(id) && cityDict != null && cityDict.ContainsKey(id))
            ? cityDict[id]
            : "Unknown";
}


@{
    ViewData["Title"] = "Browse";
    Layout = "~/Views/Shared/MasterPage.cshtml";
}
<link rel="stylesheet" href="~/CSS/BrowseCSS.css" />
<div class="main-container">
    <!-- Search Section -->
    <div class="search-section">
        

        <div class="search-filters">
            <div class="filter-group">
                <select>
                    <option>departure</option>
                    @foreach (var city in cityDict)
                    {
                        <option>@city.Value (@city.Key)</option>
                    }
                </select>
            </div>
            <div class="filter-group">
                <select>
                    <option>destination</option>
                    @foreach (var city in cityDict)
                    {
                        <option>@city.Value (@city.Key)</option>
                    }
                </select>
            </div>
            <div class="filter-group">
                <input type="date" placeholder="departure time">
            </div>
            <div class="filter-group">
                <input type="date" placeholder="arrival time">
            </div>
            <div class="filter-group">
            </div>
        </div>

        <div class="additional-options">
            <label class="checkbox-option">
                <input type="checkbox">
                view sale only
            </label>
            <button class="search-btn">
                Search Flights 🔍
            </button>
        </div>
    </div>

    <!-- Content Layout -->
    <div class="content-layout">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="sidebar-section">
                <div class="sidebar-title">sort by</div>
                <select class="sort-select">
                    <option>Price: Low to High</option>
                    <option>Price: High to Low</option>
                    <option>Duration: Shortest</option>
                    <option>Departure Time</option>
                    <option>Arrival Time</option>
                </select>
            </div>
        </div>

        @{
            int showing = Model?.flights?.Count ?? 0;
            int total = Model?.TotalCount ?? 0;
        }

        <!-- Results -->
        <div class="results-section">
            <div class="results-header">
                <span class="results-count">Showing @showing of @total flights</span>
            </div>
            
            <!-- Flight Card -->
            <div class="flights-grid">
                @foreach(Flight flight in Model.flights)
                {
                    <div class="flight-card">
                        <div class="flight-image">
                            <div class="img-placeholder"><img src="" alt="Flight Image"></div>
                        </div>
                        <div class="flight-details">
                            <div class="flight-route">
                                @NameOrUnknown(flight.Departure_Id) → @NameOrUnknown(flight.Arrival_Id)
                            </div>
                            <div class="flight-info">
                                <span class="info-item">@flight.Airline</span>
                                <span class="info-item">Departure Date: @flight.Departure_Date</span>
                                <span class="info-item">At: @flight.Departure_Time</span>
                                <span class="info-item">@flight.Flight_Number</span>
                            </div>
                            <div class="flight-price">
                                <div>
                                    <div class="price">@flight.Price$</div>
                                    <div class="price-label">per person</div>
                                </div>
                                <button class="book-btn">Book Now</button>
                            </div>
                        </div>
                    </div>
                }
                
            </div>
            <!-- Pagination -->
            <div class="pagination">
                <button class="page-btn">←</button>
                @for (int i = 1; i <= Model.pageCount; i++)
                {
                    <button class="page-btn">@i</button>
                }
                <button class="page-btn">→</button>
            </div>
        </div>
    </div>
</div>

